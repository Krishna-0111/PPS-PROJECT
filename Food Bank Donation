#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_ITEMS 100
#define MAX_REQUESTS 100

// Structure for donated items
typedef struct {
    char itemType[50];
    int quantity;
    char expiryDate[20]; // Format: YYYY-MM-DD
    char donorName[50];
    int isPerishable;
    int isExpired;
} Donation;

// Structure for recipient requests
typedef struct {
    int familySize;
    char dietaryRestrictions[100];
    int priority; // 1 = High, 2 = Medium, 3 = Low
} Request;

// Global arrays
Donation donations[MAX_ITEMS];
Request requests[MAX_REQUESTS];
int donationCount = 0;
int requestCount = 0;

// Function declarations
void addDonation();
void addRequest();
void distributeFood();
void showReport();
int isExpired(char expiryDate[]); // Dummy expiry checker

int main() {
    int choice;

    while (1) {
        printf("\n--- Food Bank Management System ---\n");
        printf("1. Add Donation\n");
        printf("2. Add Recipient Request\n");
        printf("3. Distribute Food\n");
        printf("4. Show Daily Report\n");
        printf("5. Exit\n");
        printf("Enter your choice: ");
        scanf("%d", &choice);

        switch (choice) {
            case 1: addDonation(); break;
            case 2: addRequest(); break;
            case 3: distributeFood(); break;
            case 4: showReport(); break;
            case 5: printf("Exiting program. Thank you!\n"); exit(0);
            default: printf("Invalid choice. Try again.\n");
        }
    }

    return 0;
}

//Add Donation
void addDonation () {
   if (donationCount >= MAX_ITEMS) {
      printf ("Donation storage full.\n");
      return; 
   }

   Donation d;
   printf("Enter a iteam type: ");
   scanf(" %[^\n]", d.itemType);
   printf("Enter a quantity: ");
   scanf("%d",&d.quantity);
   printf("Enter a expiry date (YYYY-MM-DD): ");
   scanf(" %[^\n]", d.expiryDate);
   printf("Enter a donor name: ");
   scanf(" %[^\n]", d.donorName);
   printf("Is iteam perishable (1=Yes, 0=No): ");
   scanf("%d", &d.isPerishable);

   d.isExpired = isExpired(d.expiryDate);

   donations[donationCount++] = d;
   printf("Donation recorded successfully.\n");
}

// Add Request
void addRequest() {
    if (requestCount >= MAX_REQUESTS) {
        printf("Request storage full.\n");
        return;
    }

    Request r;
    printf("Enter family size: ");
    scanf("%d", &r.familySize);
    printf("Enter dietary restrictions: ");
    scanf(" %[^\n]", r.dietaryRestrictions);
    printf("Enter priority (1 = High, 2 = Medium, 3 = Low): ");
    scanf("%d", &r.priority);

    requests[requestCount++] = r;
    printf("Request recorded successfully.\n");
}

// Distribute Food
void distributeFood() {
printf("\n--- Distribution Started ---\n");

for (int i = 0; i < requestcount; i++) {
request r = requests[i];
printf("Processing request %d (Priority %d)...\n", i + 1, r.priority);

for(int j = 0; i < donationcount; j++) {
Donation *d = &donation[j];

if (d->quantity > 0 && !d->isExpired) {
int allocated = r.familysize * 2; // simple logic: 2 items per person
if (allocated > d->quantity) allocated = d->quantity;

printf("Allocated %d of %s to request %d\n", allocated, d->itemtype, i + 1);
d->quantity -= allocated;
break;
}
}
}

printf("Distribution complete.\n");
}
